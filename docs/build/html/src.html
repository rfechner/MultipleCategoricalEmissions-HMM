
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>API Documentation &#8212; MultiCatEmissionHMM  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to MultiCatEmissionHMM’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-hmm">
<span id="api-documentation"></span><h1>API Documentation<a class="headerlink" href="#module-hmm" title="Permalink to this heading">¶</a></h1>
<p>Author: Richard Fechner, 2023</p>
<p>Simple Python implementation of a Hidden Markov Model 
with multiple categorical Emissionsignals.</p>
<dl class="py class">
<dt class="sig sig-object py" id="hmm.MultiCatEmissionHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hmm.</span></span><span class="sig-name descname"><span class="pre">MultiCatEmissionHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_pi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_Bs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_emission_symbols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmm.MultiCatEmissionHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Hidden Markov Model with Multiple Categorical Emissions.
This class represents a Hidden Markov Model (HMM) where the emissions are modeled
as distinct Categorical distributions. The HMM consists of a set of states, transition
probabilities between states, initial state probabilities, and multiple emission matrices.</p>
<dl class="py method">
<dt class="sig sig-object py" id="hmm.MultiCatEmissionHMM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hmm.MultiCatEmissionHMM.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>See hmmstudy.ipynb for derivations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmm.MultiCatEmissionHMM.likelihood">
<span class="sig-name descname"><span class="pre">likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#hmm.MultiCatEmissionHMM.likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the conditional likelihood p(Y_t|X_t) of an observation sequence for each hidden state.</p>
<p>Calculate the conditional likelihood p(Y_t|X_t) of an observation sequence for each hidden state.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y_i</strong> (<em>np.ndarray</em>) – Observation sequence for the emission matrices.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The product of likelihoods for the observation sequence for each hidden state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Notes<span class="colon">:</span></dt>
<dd class="field-even"><p>This method calculates the likelihood of an observation sequence for each hidden state.
The observation sequence corresponds to the emission matrices.</p>
<p>The likelihood is computed by taking the product of the probabilities of each observation
given the emission matrix for the corresponding hidden state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmm.MultiCatEmissionHMM.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#hmm.MultiCatEmissionHMM.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the posterior distribution <span class="math notranslate nohighlight">\(p(X|Ys, \theta)\)</span> over the hidden
states, given some observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Ys</strong> (<em>np.ndarray</em>) – The list of observations. Each observation comes from an individual
Categorical distribution. Shape should be (D, sum(self.num_emission_symbols)).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Posterior probabilities over hidden states. Entry [t, i] denotes the
probability of being in state i at timestep t, given all the data
<span class="math notranslate nohighlight">\(p(X_t = i|Ys, \theta)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmm.MultiCatEmissionHMM.smooth">
<span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_tp1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">updates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#hmm.MultiCatEmissionHMM.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform smoothing to estimate the hidden state probabilities at time t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>int</em>) – The timestep for which smoothing is performed.</p></li>
<li><p><strong>x_tp1</strong> (<em>np.ndarray</em>) – The posterior probability distribution over hidden states at time t+1.</p></li>
<li><p><strong>updates</strong> (<em>List</em><em>[</em><em>np.ndarray</em><em>]</em>) – List containing the filtered posterior probability distributions for each timestep.</p></li>
<li><p><strong>predictions</strong> (<em>List</em><em>[</em><em>np.ndarray</em><em>]</em>) – List containing the predicted posterior probability distributions for each timestep.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The smoothed posterior probability distribution over hidden states at time t.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmm.MultiCatEmissionHMM.update_mv">
<span class="sig-name descname"><span class="pre">update_mv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_tm1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#hmm.MultiCatEmissionHMM.update_mv" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the hidden state distribution based on the current observation.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_tm1</strong> (<em>np.ndarray</em>) – Vector of hidden state distribution from timestep t-1.</p></li>
<li><p><strong>y_t</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Sequence of integers, where each integer at index i corresponds to the observation
for the emission matrix at index i.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated posterior probability distribution over hidden states at time t.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Notes<span class="colon">:</span></dt>
<dd class="field-even"><p>This method updates the hidden state distribution at time t based on the current observation.</p>
<p>The update is performed by multiplying the likelihood of the observation given each hidden state
(calculated using the emission matrices) with the prior probability distribution over hidden states
from the previous timestep. The result is the unnormalized posterior probability distribution over
hidden states at time t.</p>
<p>In this example, ‘result’ would contain the updated posterior probability distribution over
hidden states at the current timestep based on the input observation sequence.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmm.MultiCatEmissionHMM.viterbi">
<span class="sig-name descname"><span class="pre">viterbi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#hmm.MultiCatEmissionHMM.viterbi" title="Permalink to this definition">¶</a></dt>
<dd><p>Viterbi algorithm for multivariate discrete emissions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Ys</strong> (<em>np.ndarray</em>) – nd array containing observations. Shape: (N, D)</p>
</dd>
<dt class="field-even">Notes<span class="colon">:</span></dt>
<dd class="field-even"><p>Observations are of shape (N, D) where D is the number of emission signals.
The ordering of these signals MUST correspond to the ordering in the list of emission matrices.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">MultiCatEmissionHMM</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to MultiCatEmissionHMM’s documentation!</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Richard Fechner.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/src.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>